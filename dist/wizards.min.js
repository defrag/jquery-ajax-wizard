/*! wizards - v0.1.0 - 2013-10-17
* https://github.com/michaldabrowski/wizards
* Copyright (c) 2013 Michal Dabrowski; Licensed MIT */
!function(a,b){"use strict";var c={},d={};d=function(b,c){var d=this;this.steps=[],this.elementId=b,this.currentIndex=-1,this.options={},this.currentStep=null,a.extend(this.options,c||{});var e=['<div class="wizard">','<div class="wizard-steps-container">',"</div>",'<div class="wizard-navigation">','<div class="btn-group-single">','<button class="btn wizard-prev disabled" type="button">Back</button>','<button class="btn btn-primary wizard-next" type="button">Next</button>',"</div>","</div>",'<div class="wizard-loader" style="display:none">Loading...</div>',"</div>"];this.$el=a(e.join("\n")),this.$navigation=this.$el.find(".wizard-navigation"),this.$nextButton=this.$navigation.find(".wizard-next"),this.$prevButton=this.$navigation.find(".wizard-prev"),this.$loader=this.$el.find(".wizard-loader"),this.$content=this.$el.find(".wizard-steps-container");var f=function(){d.$nextButton.on("click",function(a){a.preventDefault(),d.currentStep.doValidate().done(function(){var a=d.steps[++d.currentIndex];d.loadStep(a)})}),d.$prevButton.on("click",function(a){if(a.preventDefault(),d.$prevButton.hasClass("disabled"))return!1;var b=d.steps[--d.currentIndex];d.loadStep(b)})};!function(){f()}()},d.prototype.addStep=function(a){a.wizard=this,a.id=this.steps.length+1,this.steps.push(a)},d.prototype.loadStep=function(a){var b=this;return b.$prevButton.toggleClass("disabled",0===b.currentIndex),!0===b.$content.find("#wizard-step-"+a.id).data("has-content")?(b.$content.find(".wizard-step").hide(),b.$content.find("#wizard-step-"+a.id).show(),b.currentStep=a,void 0):(b.$loader.show(),a.load().done(function(){b.$content.find(".wizard-step").hide(),b.$content.find("#wizard-step-"+a.id).html(a.content).data("has-content",!0).show(),b.currentStep=a}).always(function(){b.$loader.hide()}),void 0)},d.prototype.render=function(){var b=this;a(this.elementId).html(this.$el);for(var c=0;c<b.steps.length;c++){var d='<div class="wizard-step" style="display:none;" id="wizard-step-'+b.steps[c].id+'"></div>';b.$content.append(d)}var e=this.steps[++this.currentIndex];b.currentStep=e,b.loadStep(e)},c=function(a){this.url=a.url,this.content="",this.validate=a.validate,this.wizard=null,this.id=null},c.prototype.load=function(){var b=a.Deferred(),c=this;return a.get(this.url).done(function(a){c.content=a,b.resolve()}),b.promise()},c.prototype.doValidate=function(){return a.isFunction(this.validate)?this.validate(this):a.Deferred().resolve().promise()},b.Wizard=d,b.WizardStep=c}(jQuery,window);